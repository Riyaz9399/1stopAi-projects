<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>HTML Calculator | Minor Project 2</title>
    <!-- bootstrap icon cdn-->
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.1/font/bootstrap-icons.css"/>
    <link rel="stylesheet" href="./vendor/BootStrap/css/bootstrap.css"/>
    <style>
        .calc-btn{
            width:70px;
            height:70px;
        }
        .calc-display{
            margin-top: 7px;
            background-color: gray;
            color: white;
            height: 100px;
            width: 320px;
            border-radius: 5px;
            border-style:2px solid black;
        }
        .inputString{
            margin-top: 5px;
            height: 20px;
            display: block;
            font-size: 20px;
        }
        .expressionString{
            margin-top: 5px;
            height: 20px;
            display: block;
            font-size: 20px;
        }
        .valueString{
            margin-top: 5px;
            height: 20px;
            display: block;
            font-size: 20px;
        }
    </style>
</head>
<body>

    
    <div class="container p-5">
        <div class="d-flex justify-content-center" >
           <div class="col-sm-12 col-md-4 col-lg-4">
              <div class="card" >
                <div class="d-flex justify-content-center ">
                    <div class="row">
                        <div class=" container col-sm-12 col-md-12 col-lg-12 col-xl-12 calc-display">
                            <div id="number_div" class="inputString">0</div>
                            <div id="expression" class="expressionString"></div>
                            <div id="value_div" class="valueString"></div>
                        </div>
                        <input type="hidden"  id="savedExpression" />
                    </div>
                </div> 
               <div class="d-flex justify-content-center p-3 align-item-center ">
                    <div class="row">
                        <div class="col-sm-3 col-md-3 col-lg-3 col-xl-3 ">
                            <button type="button" class="btn btn-light calc-btn" data-event_key="NumLock"><small>Num Lock</small></button>
                        </div>
                        <div class="col-sm-3 col-md-3 col-lg-3 col-xl-3">
                            <button type="button" class="btn btn-light calc-btn" data-event_key="Delete">CE</button>
                        </div>
                        <div class="col-sm-3 col-md-3 col-lg-3 col-xl-3">
                            <button type="button" class="btn btn-light calc-btn" data-event_key="Delete">Del</button>
                        </div>
                        <div class="col-sm-3 col-md-3 col-lg-3 col-xl-3">
                            <button type="button" class="btn btn-light calc-btn" data-event_key="/">/</button>
                        </div>
                    </div>
                </div> 
                <div class="d-flex justify-content-center p-3 align-item-center">
                    <div class="row">
                        <div class="col-sm-3 col-md-3 col-lg-3 col-xl-3">
                            <button type="button" class="btn btn-light calc-btn" data-event_key="7">7</button>
                        </div>
                        <div class="col-sm-3 col-md-3 col-lg-3 col-xl-3">
                            <button type="button" class="btn btn-light calc-btn" data-event_key="8">8</button>
                        </div>
                        <div class="col-sm-3 col-md-3 col-lg-3 col-xl-3">
                            <button type="button" class="btn btn-light calc-btn" data-event_key="9">9</button>
                        </div>
                        <div class="col-sm-3 col-md-3 col-lg-3 col-xl-3">
                            <button type="button" class="btn btn-light calc-btn" data-event_key="*">*</button>
                        </div>
                    </div>
                </div>    
                <div class="d-flex justify-content-center p-3 align-item-center">
                    <div class="row">
                        <div class="col-sm-3 col-md-3 col-lg-3 col-xl-3">
                            <button type="button" class="btn btn-light calc-btn" data-event_key="4">4</button>
                        </div>
                        <div class="col-sm-3 col-md-3 col-lg-3 col-xl-3">
                            <button type="button" class="btn btn-light calc-btn" data-event_key="5">5</button>
                        </div>
                        <div class="col-sm-3 col-md-3 col-lg-3 col-xl-3">
                            <button type="button" class="btn btn-light calc-btn" data-event_key="6">6</button>
                        </div>
                        <div class="col-sm-3 col-md-3 col-lg-3 col-xl-3">
                            <button type="button" class="btn btn-light calc-btn" data-event_key="-">-</button>
                        </div>
                    </div>
                </div>    
                <div class="d-flex justify-content-center p-3 align-item-center">
                     <div class="row">
                        <div class="col-sm-3 col-md-3 col-lg-3 col-xl-3">
                            <button type="button" class="btn btn-light calc-btn" data-event_key="1">1</button>
                        </div>
                        <div class="col-sm-3 col-md-3 col-lg-3 col-xl-3">
                            <button type="button" class="btn btn-light calc-btn" data-event_key="2">2</button>
                        </div>
                        <div class="col-sm-3 col-md-3 col-lg-3 col-xl-3">
                            <button type="button" class="btn btn-light calc-btn" data-event_key="3">3</button>
                        </div>
                        <div class="col-sm-3 col-md-3 col-lg-3 col-xl-3">
                            <button type="button" class="btn btn-light calc-btn" data-event_key="+">+</button>
                        </div>
                    </div>
                </div>    
                <div class="d-flex justify-content-center p-3 align-item-center">
                    <div class="row">
                        <div class="col-sm-6 col-md-6 col-lg-6 col-xl-6">
                            <button type="button" class="btn btn-light calc-btn" style="width:170px;" data-event_key="0">0</button>
                        </div>
                        
                        <div class="col-sm-3 col-md-3 col-lg-3 col-xl-3">
                            <button type="button" class="btn btn-light calc-btn" data-event_key=".">.</button>
                        </div>
                        <div class="col-sm-3 col-md-3 col-lg-3 col-xl-3">
                            <button type="button" class="btn btn-light calc-btn" data-event_key="=">=</button>
                        </div>
                    </div>
                </div>    
                                   
              </div>
           </div>
         </div>
    </div>


    <script src="./vendor/jquery/jquery.min.js" ></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/2.11.8/umd/popper.min.js" integrity="sha512-TPh2Oxlg1zp+kz3nFA0C5vVC6leG/6mm1z9+mA81MI5eaUVqasPLO8Cuk4gMF4gUfP5etR73rgU/8PNMsSesoQ==" crossorigin="anonymous" referrerpolicy="no-referrer"></script>
    <script src="./vendor/BootStrap/js/bootstrap.js"></script>
    <script>
        $(document).on('keypress', function(e){
            $('button[data-event_key="'+e.key+'"]').addClass("active");
            if((e.keycode >= 48 && e.keycode <=57) || (e.keycode >= 96 && e.keycode <= 105)){
                appendNumber(e.key);  
            }
            else{
                if(key == "+" || key == "-" || key == "*" || key == "/" ){
                    generateExpression(key);
                } else if(key == "="){
                    evaluateExpression();
                }else if(key == "Delete"){
                    clearCalc();
                }
            }
            console.log(e.key);
        })
        $(document).on('keyup', function(e){
            $('button[data-event_key="'+e.key+'"]').removeClass("active");
            console.log(e.key);
        })
        $('.calc-btn').on('click', function(e){
            var key =$(this).data('event_key');
            if(key != '+'&& key != '-'&& key != '*'&& key != '.'&& key != '/'&& key != '='&& key != 'Delete'&& key != 'NumLock'){
                appendNumber(key);
            }
            else{
            if(key == "+" || key == "-" || key == "*" || key == "/" ){
                    generateExpression(key);
                }else if(key == "="){
                    evaluateExpression();
                }else if(key == "Delete"){
                    clearCalc();
                }
            }    
            console.log(key);
        })
        function appendNumber(number){
            var existingNumber = $("#number_div").html();
            console.log(existingNumber);
            var currentString = number;
            var outputstring = " ";
            if(existingNumber != " " && existingNumber != undefined && existingNumber != null){
                if(existingNumber == 0){
                    outputstring = number;
                }else{
                    outputstring = existingNumber + currentString;
                }
            }
            else{
               outputstring = currentString;
            }
            $("#number_div").html(outputstring); 
        }
        function generateExpression(operator){
            var existingNumber = $("#number_div").html();
            var currentOperator = operator;
            var expression = '';
            var savedExpression = $("#savedExpression").val();
            if(savedExpression == '' || savedExpression == null || savedExpression == undefined){
                expression = parseInt(existingNumber) + operator;
            }else {
                expression = savedExpression + existingNumber + operator;
            }
            $("#number_div").html("");
            $("#savedExpression").val(expression);
            $("#expression").html(expression);
        }

        function evaluateExpression(){
            var result = '';
            var expression = $("#savedExpression").val(); 
            var existingNumber = $("#number_div").html();
            if(existingNumber != "" || existingNumber != null || existingNumber != undefined){
                expression = expression + parseInt(existingNumber);
                $("#expression").html(expression);
            }
            result = eval(expression);
            $("#savedExpression").val('');
            $("#number_div").html(result);
            $("#value_div").html(result);
        }

       function clearCalc(){
            $("#savedExpression").val('');
            $("#number_div").html('');
            $("#value_div").html('');
            $("#expression").html('');
       }

    </script>
</body>
</html>